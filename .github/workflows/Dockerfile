FROM node:16-alpine
RUN apk add tini
ENTRYPOINT ["tini", "--"]
WORKDIR /usr/src/app
COPY . .
ARG SECRET_COOKIE_PASSWORD
ARG GOOGLE_ANALYTICS_ID
ARG SERVICE_URL
ARG SENTRY_DSN
ARG SENTRY_AUTH_TOKEN
ARG MAILCHIMP_ID
ARG FACEBOOK_PIXEL
ARG ENVIRONMENT
ARG GLEAM_REWARD_URL
ARG ROOT_SEED
ARG NODE_PROVIDER
ENV SECRET_COOKIE_PASSWORD=$SECRET_COOKIE_PASSWORD
ENV GOOGLE_ANALYTICS_ID=$GOOGLE_ANALYTICS_ID
ENV SERVICE_URL=$SERVICE_URL
ENV SENTRY_DSN=$SENTRY_DSN
ENV SENTRY_AUTH_TOKEN=$SENTRY_AUTH_TOKEN
ENV FACEBOOK_PIXEL=$FACEBOOK_PIXEL
ENV MAILCHIMP_ID=$MAILCHIMP_ID
ENV ENVIRONMENT=$ENVIRONMENT
ENV GLEAM_REWARD_URL=$GLEAM_REWARD_URL
ENV PLPD_CONTRACT_PUBLIC_KEY="0x6dcd188658f5059208e9182e6f66d617af614a919b14e5d09e070fc6e2559832"
ENV STAKING_CONTRACT_PUBLIC_KEY="0xd5caf54ba46364e753f583bd223a7d5b9e455fc6ac837b158318c76e38bc58b2"
ENV ROOT_SEED=$ROOT_SEED
ENV NODE_PROVIDER=$NODE_PROVIDER
RUN npm install -g npm@8.12.1
RUN npm run-script build
CMD ["npm", "run-script", "start"]
